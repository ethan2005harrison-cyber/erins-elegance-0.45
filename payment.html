<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0" />
<title>Payment - Erin‚Äôs Elegance</title>
<link rel="icon" href="https://cdn-icons-png.flaticon.com/512/4150/4150897.png" type="image/png">
<style>
@import url('https://fonts.googleapis.com/css2?family=Playfair+Display:wght@400;600&family=Open+Sans:wght@300;400;600&display=swap');

body {
  margin:0;
  font-family:'Open Sans',sans-serif;
  background-color:#D8E3DC;
  color:#222;
}

/* HEADER */
header { background-color: rgba(255,255,255,0.4); backdrop-filter: blur(10px); position: fixed; width: 100%; top:0; z-index:10; }
.header-container { max-width:1200px; margin:0 auto; display:flex; justify-content:space-between; align-items:center; padding:1.2rem 2rem; }
.logo { font-family:'Playfair Display', serif; font-size:1.5rem; color:#111; font-weight:600; }
nav ul { list-style:none; display:flex; gap:1.5rem; margin:0; padding:0; }
nav ul li a { text-decoration:none; color:#111; font-weight:500; transition: color 0.3s; }
nav ul li a:hover { color:#a18449; }

/* MAIN */
main { max-width:600px; margin:12rem auto 4rem; padding:0 2rem; text-align:center; }
h1 { font-family:'Playfair Display', serif; font-size:2.5rem; margin-bottom:1rem; color:#111; }
p { font-size:1.1rem; color:#333; margin-bottom:2rem; }

#summary { background:#fff; border-radius:16px; padding:1.5rem; box-shadow:0 4px 12px rgba(0,0,0,0.1); margin-bottom:2rem; text-align:left; }
#summary h3 { font-family:'Playfair Display', serif; margin-top:0; color:#111; }
#summary ul { list-style:none; padding:0; margin:0.5rem 0 1rem; }
#summary ul li { padding:0.3rem 0; border-bottom:1px solid #eee; display:flex; justify-content:space-between; }
#summary .total { font-weight:600; text-align:right; font-family:'Playfair Display', serif; color:#a18449; }

.payment-options { display:flex; flex-direction:column; gap:1rem; }
.payment-option { display:flex; justify-content:space-between; align-items:center; padding:1rem 1.2rem; border-radius:12px; border:1px solid #ccc; background:#fff; transition:background 0.3s, border-color 0.3s; }
.payment-option.active { border-color:#a18449; background:#f7f3ec; }
.payment-option.disabled { opacity:0.5; cursor:not-allowed; }
.payment-option.disabled::after { content:"Currently Unavailable"; font-size:0.9rem; color:#a18449; font-weight:600; margin-left:10px; }

button { background-color:#a18449; color:white; border:none; padding:1rem 2.5rem; border-radius:50px; font-size:1rem; cursor:pointer; margin-top:2rem; transition:background-color 0.3s, transform 0.2s; }
button:hover { background-color:#8c703b; transform: translateY(-2px); }
button:disabled { opacity:0.6; cursor:not-allowed; }

#statusMessage {
  margin-top: 1rem;
  font-size: 1rem;
  font-weight: 600;
  color: #a18449;
  display: none;
  text-align: center;
}

footer { text-align:center; padding:2rem; font-size:0.9rem; color:#444; opacity:0.7; margin-top:2rem; }
</style>
</head>
<body>

<header>
<div class="header-container">
  <div class="logo">erin‚Äôs elegance</div>
  <nav>
    <ul>
      <li><a href="index.html">Home</a></li>
      <li><a href="booking.html">Booking</a></li>
      <li><a href="about.html">About</a></li>
    </ul>
  </nav>
</div>
</header>

<main>
<h1>Review & Payment</h1>
<p>Please review your booking details below and confirm your appointment.</p>

<div id="summary">
  <h3>Your Booking:</h3>
  <ul id="serviceList"></ul>
  <div class="total" id="totalCost">Total: ¬£0</div>
  <h3>Customer Details:</h3>
  <p id="customerDetails"></p>
</div>

<div class="payment-options">
  <div class="payment-option active" id="payInPerson">
    <span>üí≥ Pay in person</span>
    <small>Please bring a method of payment with you.</small>
  </div>
  <div class="payment-option disabled">
    <span>üÖøÔ∏è Pay with PayPal</span>
  </div>
</div>

<button id="confirmBtn">Confirm Booking</button>
<div id="statusMessage">Submitting your booking...</div>
</main>

<footer>
<p>¬© 2025 erin‚Äôs elegance. all rights reserved.</p>
</footer>

<script>
// Grab URL parameters
const params = new URLSearchParams(window.location.search);
const serviceListElem = document.getElementById("serviceList");
const totalCostElem = document.getElementById("totalCost");
const customerDetailsElem = document.getElementById("customerDetails");
const statusMessage = document.getElementById("statusMessage");
const confirmBtn = document.getElementById("confirmBtn");

let total = 0;
let services = [];

params.getAll("service").forEach(s => {
  const [name, price] = s.split(" - ");
  const li = document.createElement("li");
  li.textContent = `${name.trim()} - ¬£${price.trim()}`;
  serviceListElem.appendChild(li);
  total += parseInt(price.trim());
  services.push({name: name.trim(), price: parseInt(price.trim())});
});
totalCostElem.textContent = `Total: ¬£${total}`;

// Customer info
const name = params.get("name") || "";
const email = params.get("email") || "";
const phone = params.get("phone") || "";
const desiredDate = params.get("desiredDate") || "";
const notes = params.get("notes") || "";

customerDetailsElem.innerHTML = `
<strong>Name:</strong> ${name}<br>
<strong>Email:</strong> ${email}<br>
<strong>Phone:</strong> ${phone}<br>
<strong>Date:</strong> ${desiredDate}<br>
<strong>Notes:</strong> ${notes || "None"}
`;

// Handle confirm booking
confirmBtn.addEventListener("click", () => {
  confirmBtn.disabled = true;
  statusMessage.style.display = "block";
  statusMessage.textContent = "Submitting your booking...";

  // Construct Formspree form data
  const formData = new FormData();
  formData.append("Name", name);
  formData.append("Email", email);
  formData.append("Phone", phone);
  formData.append("Desired Date", desiredDate);
  formData.append("Notes", notes);
  services.forEach(s => formData.append("Service", `${s.name} - ¬£${s.price}`));
  formData.append("Total", `¬£${total}`);

  fetch("https://formspree.io/f/xdkwjqyl", {
    method: "POST",
    body: formData,
    headers: { 'Accept': 'application/json' }
  })
  .then(response => {
    if (response.ok) {
      statusMessage.textContent = "Booking confirmed! Redirecting...";
      setTimeout(() => window.location.href = "thankspage.html", 1500);
    } else {
      throw new Error("Formspree submission failed.");
    }
  })
  .catch(error => {
    statusMessage.textContent = "There was a problem submitting your booking. Please try again.";
    confirmBtn.disabled = false;
    console.error(error);
  });
});
</script>

</body>
</html>
